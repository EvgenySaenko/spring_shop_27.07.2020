<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Product Table</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
</head>

<body>
    <div class="container">
        <h2>Фильтр</h2>
        <form th:accept="@{'/products'}" method="get">
            <div class="form-group">
                <label>Минимальная цена</label>
                <!-- thymeleaf позволяет доставать напрямую параметр min_cost или max_cost-->
                <input type="number" th:value="${param.min_cost != null ? param.min_cost : ''}" class="form-control" name="min_cost">
            </div>
            <div class="form-group">
                <label>Максимальная цена</label>
                <input type="number" th:value="${param.max_cost != null ? param.max_cost : ''}" class="form-control" name="max_cost">
            </div>
            <button type="submit" class="btn btn-primary">Применить</button>
        </form>

        <h2>Список товаров</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <td><b>id</b></td>
                <td><b>наименование</b></td>
                <td><b>стоимость</b></td>
            </tr>
            </thead>
            <tbody>
               <!--/* @thymesVar id="products" th:type="java.util.List<ru.geekbrains.sample.persistence.entities.Product>"*/-->
               <tr th:each="product, iterator : ${products.getContent()}">
                        <span >
                            <td th:text="${iterator.index + 1}"/>
                            <td><a th:href="@{'/products/' +  ${product.id}}">[[ ${product.name} ]]</a></td>
                            <td th:text="${product.cost}"></td>
                            <td> <a th:href="@{'/products/edit/' + ${product.id}}">редактировать товар</a></td>
                        </span>
               </tr>
            </tbody>
        </table>

        <!--сформируем элемент с номером страницы     -->
        <!--получаем числовую последовательность от 1 до (сколько у нас есть всего страниц) -->
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <li class="page-item">
                    <a class="page-link"
                       th:href="@{'/products/?page='+ ${products.previousOrFirstPageable().getPageNumber() + 1} + ${filterDef}}">Назад</a>
                </li>
                <!--если норер страницы текущей = page то мы ее подсветим -->
                <li class="page-item" th:classappend="${products.getNumber() + 1 == i ? 'active' : ''}"
                    th:each="i : ${#numbers.sequence(1, products.getTotalPages())}">
                    <a class="page-link" th:text="${i}" th:href="@{'/products/?page=' + ${i} + ${filterDef}}"></a>
                </li>

                <li class="page-item">
                    <a class="page-link"
                       th:href="@{'/products/?page='+ ${products.nextOrLastPageable().getPageNumber() + 1} + ${filterDef}}">Вперед</a>
                </li>
            </ul>
        </nav>

        <hr><br>
    <!--    <ul>-->
    <!--        <li style="display: inline; margin-right: 5px;border: 1px solid #000;padding: 3px;" ><a th:href="@{'/products/?page=' + ${1}}">1</a></li>-->
    <!--        <li style="display: inline; margin-right: 5px;border: 1px solid #000;padding: 3px;"><a th:href="@{'/products/?page=' + ${2}}">2</a></li>-->
    <!--        <li style="display: inline; margin-right: 5px;border: 1px solid #000;padding: 3px;"><a th:href="@{'/products/?page=' + ${3}}">3</a></li>-->
    <!--        <li style="display: inline; margin-right: 5px;border: 1px solid #000;padding: 3px;"><a th:href="@{'/products/?page=' + ${4}}">4</a></li>-->
    <!--    </ul>-->
        <!--    @ - это contextPath(корень нашего приложения)-->
        <br>
        <br>
        <a th:href="@{'/products/add'}">Добавить новый товар</a>
        <br>
        <br>
        <a th:href="@{/}">Главная страница</a>
        </div>
</body>
</html>